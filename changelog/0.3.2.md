# Nexus 0.3.2 - August 20, 2025

## Summary
This release introduces AWS Bedrock as a new LLM provider, bringing support for multiple foundation models through a single unified interface. The AWS Bedrock integration provides access to models from AI21, Anthropic, Amazon, Meta, Cohere, DeepSeek, and Mistral, significantly expanding the AI capabilities available through Nexus. Additionally, this release includes important compatibility fixes for the RMCP library and dependency updates.

## New Features

### AWS Bedrock LLM Provider Support
**User Impact:** Users can now access a wide variety of foundation models through AWS Bedrock, including Claude, Llama, Jamba, Amazon Nova, and many others via a single provider configuration. This provides enterprise-grade AI capabilities with AWS-native security and compliance.

**Technical Details:**
- Implemented AWS Bedrock provider with support for 8 model families
- Each model family has dedicated input/output transformation modules for proper API compatibility
- Full streaming support for all compatible Bedrock models
- Automatic model family detection and routing based on model ID
- Files added/modified:
  - `crates/llm/src/provider/bedrock.rs` - Core Bedrock provider implementation
  - `crates/llm/src/provider/bedrock/families/` - Model family-specific implementations
    - AI21 Jamba models (256K context window)
    - Anthropic Claude models (all Claude 3 variants)
    - Amazon Nova (Micro, Lite, Pro) and Titan models
    - Meta Llama 2 and Llama 3 models
    - Cohere Command models
    - DeepSeek R1 reasoning models
    - Mistral 7B and Mixtral models
  - `crates/config/src/llm.rs` - Configuration support for Bedrock provider
  - `crates/integration-tests/tests/llm/bedrock/` - Test suite
- Authentication leverages standard AWS credential chain (environment, profile, IAM role, SSO)
- Regional endpoint support with configurable AWS region
- Model IDs follow pattern: `provider.model-name-version:revision`

**Configuration Example:**
```toml
[llm.providers.bedrock]
type = "bedrock"
region = "us-west-2"
profile = "my-aws-profile"  # Optional

[llm.providers.bedrock.models."anthropic.claude-3-5-sonnet-20241022-v2:0"]
[llm.providers.bedrock.models."amazon.nova-micro-v1:0"]
[llm.providers.bedrock.models."meta.llama3-8b-instruct-v1:0"]
```

### Integration Test Macros
**User Impact:** Improved developer experience for writing integration tests with new procedural macros.

**Technical Details:**
- Added new `integration-test-macros` crate for test automation
- Provides `#[integration_test]` attribute macro for streamlined test setup
- Files added:
  - `crates/integration-test-macros/Cargo.toml` - Macro crate configuration
  - `crates/integration-test-macros/src/lib.rs` - Procedural macro implementation
- Simplifies test configuration and reduces boilerplate code

## Bug Fixes

### Fixed RMCP Library Breaking Changes
**Issue:** The RMCP library v0.6.0 introduced breaking API changes that prevented compilation.

**Resolution:** Updated all RMCP API calls to match the new v0.6.0 interface requirements.

**Technical Details:**
- Updated method signatures and parameter types across MCP server implementations
- Files modified:
  - `crates/integration-tests/src/lib.rs` - Updated test client implementations
  - `crates/integration-tests/tests/rate_limiting/memory.rs` - Fixed rate limiting tests
  - `crates/integration-tests/tests/rate_limiting/redis.rs` - Fixed Redis-based tests
  - `crates/mcp/src/server.rs` - Updated MCP server API calls
- Ensures compatibility with latest RMCP library features and improvements

## Infrastructure Updates

### Dependency Updates
- **RMCP**: Updated from v0.5.x to v0.6.0 - Major update with API improvements
- **serde_json**: Updated to v1.0.143 - Performance and compatibility improvements
- **logforth**: Updated to v0.27.0 - Enhanced logging capabilities
- **tiktoken-rs**: Updated to v0.7 - Token counting improvements
- **async-trait**: Updated to v0.1.89 - Async trait handling improvements

### Documentation Improvements
- Added AWS Bedrock configuration documentation in README.md
- Updated integration test documentation with new Bedrock examples
- Enhanced LLM provider documentation with model family details

## Performance Optimizations

### Model Resolution Enhancement
**Technical Details:**
- Improved `ModelManager` resolution logic for faster model lookup
- Optimized model family detection in Bedrock provider
- Reduced allocation overhead in model configuration parsing

## Deployment Notes

### Configuration Changes
- **New Provider Type**: `bedrock` is now a valid LLM provider type
- **AWS Credentials**: Bedrock provider requires valid AWS credentials via environment, profile, or IAM role
- **Model IDs**: Bedrock model IDs must be quoted in TOML due to dots in names (e.g., `[llm.providers.bedrock.models."anthropic.claude-3-5-sonnet-20241022-v2:0"]`)

### Breaking Changes
- None - This release maintains backward compatibility with existing configurations

### Migration Steps
To add AWS Bedrock support to existing installations:
1. Ensure AWS credentials are configured (environment variables or AWS profile)
2. Add Bedrock provider configuration to your `nexus.toml`
3. Configure desired models with their full Bedrock model IDs
4. Optional: Use model renaming for simpler access patterns

### Important Notes
- **Token Forwarding**: Not supported for Bedrock provider due to AWS IAM authentication requirements
- **Regional Availability**: Model availability varies by AWS region - check AWS documentation for your region

## Testing
- Added integration test suite for AWS Bedrock with all supported model families
- Live integration tests available for testing against actual AWS Bedrock endpoints
- Updated existing tests to ensure compatibility with RMCP v0.6.0
- All tests passing with new dependencies and features
