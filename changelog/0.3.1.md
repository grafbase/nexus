# Nexus 0.3.1 - August 18, 2025

## Summary
This patch release fixes critical validation issues with the MCP search tool's output schema that were causing errors with MCP Inspector and other MCP validation tools. The fix ensures full compatibility with MCP standards while maintaining backward compatibility for existing integrations.

## Bug Fixes

### Fixed MCP Search Tool Output Schema Validation
**Issue:** The search tool's output schema was causing validation errors when used with MCP Inspector and other MCP validation tools, preventing proper integration with MCP-compliant clients.

**Resolution:** Restructured the search tool's response format to comply with MCP schema validation requirements.

**Technical Details:**
- Wrapped search results in an object with a "results" property instead of returning a raw array
  - New format: `{"results": [...]}`
  - This addresses MCP Inspector's requirement for root-level objects
- Removed problematic `$schema` field that MCP Inspector doesn't recognize
- Removed `format: "float"` specifications that cause validation errors
- Implemented a new `McpCompatibilityTransform` to clean schemas for MCP compliance
- Standardized property ordering across the schema using the new transform system
- Files modified:
  - `crates/mcp/src/server/search.rs` - Core schema generation and transformation logic
  - `crates/mcp/src/server.rs` - Updated search result handling
  - `crates/integration-tests/src/lib.rs` - Added backward compatibility for both response formats
  - `crates/integration-tests/tests/*` - Updated test expectations
- Added comprehensive test coverage in `crates/integration-tests/tests/streamable_http/output_schema.rs` to prevent regressions
- Maintained backward compatibility in the MCP test client to support both new and legacy response formats

**User Impact:** MCP tools and validators will now properly recognize and validate the search tool's output, enabling seamless integration with MCP Inspector and other MCP-compliant systems.

## Infrastructure Updates

### Dependency Updates
- Updated `thiserror` crate to v2.0.15 for improved error handling

## Deployment Notes
- No configuration changes required
- Backward compatible with existing MCP clients
- Existing integrations will continue to work without modification due to built-in backward compatibility layer

## Testing
All existing integration tests have been updated to validate the new schema format. A new comprehensive test suite has been added specifically for output schema validation to ensure continued compliance with MCP standards.
