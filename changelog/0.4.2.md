# Nexus 0.4.2 - September 10, 2025

## Summary

This release introduces parent-based sampling for distributed tracing, enabling Nexus to respect trace sampling decisions from upstream services. This ensures consistent sampling across microservice architectures and improves trace coherence in distributed systems.

## New Features

### Parent-Based Sampling for Distributed Tracing

**User Impact:** Nexus now respects trace sampling decisions from parent services when `parent_based_sampler.enabled` is set to `true`. This ensures that when a trace is sampled by an upstream service, all downstream operations in Nexus will also be sampled, providing complete end-to-end trace visibility across distributed systems.

**Technical Details:**
- **Implementation:** New parent-based sampling logic that checks incoming trace context for sampling decisions
- **Files Modified:**
  - `crates/server/src/tracing.rs` - Enhanced tracing middleware with parent-based sampling support
  - `crates/server/src/lib.rs` - Updated service initialization for parent-based sampling configuration
  - `README.md` - Added configuration documentation for parent-based sampling
- **Sampling Logic:**
  - When enabled: Respects parent's sampling decision from trace context headers
  - When disabled: Uses local sampling ratio regardless of parent decision
  - Fallback: Uses local `ratio` when no parent trace context is present
- **Performance:** Zero overhead when disabled, minimal CPU impact when enabled
- **Standards:** Full W3C TraceContext specification compliance

## Deployment Notes

### Configuration

To enable parent-based sampling, update your `nexus.toml`:

```toml
[telemetry.tracing]
sampling = 0.1  # Local sampling ratio (10%)
parent_based_sampler = true # Respect parent's sampling decision
```
